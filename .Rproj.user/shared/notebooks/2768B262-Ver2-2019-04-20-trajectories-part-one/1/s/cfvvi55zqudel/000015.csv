"0","ManualSearch <- function( param.grid, N, initial.values, times, observed ) {"
"0","  param.grid$MSE <- NA"
"0","  for( i in 1:nrow( param.grid ) ) {"
"0","      param.grid$MSE[i] <- (1/N) * sum( ComputeResid( c( zeta = param.grid$grid.zeta[i], "
"0","                                                         eta = param.grid$grid.eta[i] ),"
"0","                                                      initial.values, "
"0","                                                      times, "
"0","                                                      observed)^2"
"0","                                      )    "
"0","  }"
"0","  return( param.grid )"
"0","}"
"0","# number of points in time series"
"0","N <- nrow( df )"
"0","# for the coarse grid"
"0","coarse.param.grid <- expand.grid( grid.zeta = seq(-1.0, 0, by = 0.05), "
"0","                           grid.eta = seq(-1.0, 0, by = 0.05) )"
"0","coarse.est <- ManualSearch( coarse.param.grid, N,"
"0","                            initial.values = c(y1 = 5, y2 = -2.5),"
"0","                            times = seq(1,100, by = 1),"
"0","                            observed = df$x "
"0",")"
"0","# and for a fine grid, near the minimum found by coarse grid evaluation"
"0","fine.param.grid <- expand.grid( grid.zeta = seq(-0.15, -0.05, by = 0.005),"
"0","                           grid.eta = seq(-0.55, -0.45, by = 0.005) )"
"0","fine.est <- ManualSearch( fine.param.grid, N,"
"0","                          initial.values = c(y1 = 5, y2 = -2.5),"
"0","                          times = seq(1,100, by = 1),"
"0","                          observed = df$x "
"0",")"
"0","min.zeta <- fine.est$grid.zeta[ which.min( fine.est$MSE ) ]"
"0","min.eta  <- fine.est$grid.eta[ which.min( fine.est$MSE ) ]"
"0","scaleFUN <- function(x) sprintf(""%.2f"", x)"
"0","p.coarse <- ggplot( coarse.est, aes( x = grid.zeta, y = grid.eta, fill = MSE ) ) + geom_tile() + "
"0","                    scale_fill_viridis_c() + "
"0","                    annotate( ""point"", x = min.zeta, y = min.eta, size = 4, colour = ""white"") +"
"0","                    geom_hline( yintercept = min.eta, colour = ""white"" ) +"
"0","                    geom_vline( xintercept = min.zeta, colour = ""white"" ) +"
"0","                    ggtitle(""Coarse Grid"") +"
"0","                    labs( y = expression(eta),"
"0","                          x = expression(zeta) ) +"
"0","                    scale_y_continuous(labels=scaleFUN) +"
"0","                    scale_x_continuous(labels=scaleFUN) +"
"0","                    coord_fixed() + "
"0","                    dwjtheme"
"0","p.fine <- ggplot( fine.est, aes( x = grid.zeta, y = grid.eta, fill = MSE ) ) + geom_tile() + "
"0","                    scale_fill_viridis_c() + "
"0","                    annotate( ""point"", x = min.zeta, y = min.eta, size = 4, colour = ""white"") +"
"0","                    geom_hline( yintercept = min.eta, colour = ""white"" ) +"
"0","                    geom_vline( xintercept = min.zeta, colour = ""white"" ) +"
"0","                    ggtitle(""Fine Grid"") +"
"0","                    labs( y = expression(eta),"
"0","                          x = expression(zeta) ) +"
"0","                    scale_y_continuous(labels=scaleFUN) +"
"0","                    scale_x_continuous(labels=scaleFUN) +"
"0","                    coord_fixed() +"
"0","                    dwjtheme"
"0","grid.arrange( p.coarse, p.fine, ncol = 2 )"
